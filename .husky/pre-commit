#!/usr/bin/env sh

# Pre-commit hook: Rodar testes antes do commit
#
# IMPORTANTE: Este hook funciona perfeitamente no Linux/macOS/WSL2
# No Windows nativo, Vitest causa segmentation fault via Git hooks
#
# Detec√ß√£o autom√°tica do ambiente:
if [ -n "$WSL_DISTRO_NAME" ] || [ "$(uname -s)" = "Linux" ] || [ "$(uname -s)" = "Darwin" ]; then
  # WSL2, Linux ou macOS - rodar testes normalmente
  echo ""
  echo "üß™ Rodando testes..."
  pnpm test:run
else
  # Windows nativo - apenas avisar
  echo ""
  echo "‚ö†Ô∏è  Windows detectado: testes via Git hook causam segfault"
  echo "‚úÖ Execute manualmente: pnpm test:run"
  echo ""
fi